# Микросервис с API для проверок станций метро

Для запуска сервиса необходимо в командной строке, находясь в корне проекта(`/building`), выполнить.

Создать репозиторий миграции:
```
flask db init
```
После выполнить миграцию БД:
```
flask db migrate -m 'building table'
```
Применяем миграцию в БД:
```
flask db upgrade
```
После этих действий в корне проекта будет создана БД SQLite `app.db`

Для запуска сервиса необходимо выполнить:
```
python runner.py
```
Будет запущен сервис на хосте: `http://127.0.0.1:5000/`

Для добавления здания необходимо на url `/building` отправить **POST** запрос с телом, 
содержащим массив объектов. Ключи которого являются: `address`, `year`:

```javascript
[
    {
        "address": "Москва",
        "year": "2020"
    },
    ...
]
```
После успешного создания будет возвращет ответ `Created`, с HTTP-кодом 201.

Для добавления кирпичей в здания необходимо на url `/building/{id}/add-bricks` отправить **POST** запрос с телом, 
содержащим объект. Ключом которого является `count_bricks`.
   * динамическое поле *{id}* яляется идентификатором здания и может быть только integer.

```javascript
    {
        "count_bricks": "600",  // количество добавляемых кирпичей   
    }
```
После успешного создания будет возвращет ответ `Updated building ID: {id}`, с HTTP-кодом 201.

Для получения статистики по годоам, необходимо отправить **GET** запрос на URl: `/stats`.
Будет возвращен объект структуры, с HTTP-кодом 200:
```javascript
{
  "2020": [                  // год постройки
    {
      "address": "Москва",   // адрес
      "count_bricks": 2400,  // количество кирпичей
      "id": 1                // идентификатор здания
    },
    ...
  ]
}
```